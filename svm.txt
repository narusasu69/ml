import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv(r"C:\Users\hp\Desktop\ml dataset\mushrooms.csv")

df 

df.describe()

df.info()

df.isnull().sum()

from sklearn.preprocessing import LabelEncoder
lc = LabelEncoder()

for column in df.columns:
    df[column] = lc.fit_transform(df[column])
    

df

X=df.iloc[:,1:24].values
y = df.iloc[:,0].values

X

y

from sklearn.model_selection import train_test_split
X_train,X_test , y_train , y_test = train_test_split(X,y,test_size = 0.25 , random_state = 42)

X_train

X_test

from sklearn.svm import SVC
clf = SVC()
clf.fit(X_train , y_train)

y_pred = clf.predict(X_test)

from sklearn.metrics import confusion_matrix , accuracy_score
cm = confusion_matrix(y_test , y_pred)
accu = accuracy_score(y_test ,y_pred)*100

cm

accu

